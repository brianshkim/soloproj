{"ast":null,"code":"'use strict';\n\nvar types = require('pg-types');\n\nvar matchRegexp = /^([A-Za-z]+)(?: (\\d+))?(?: (\\d+))?/; // result object returned from query\n// in the 'end' event and also\n// passed as second argument to provided callback\n\nclass Result {\n  constructor(rowMode, types) {\n    this.command = null;\n    this.rowCount = null;\n    this.oid = null;\n    this.rows = [];\n    this.fields = [];\n    this._parsers = undefined;\n    this._types = types;\n    this.RowCtor = null;\n    this.rowAsArray = rowMode === 'array';\n\n    if (this.rowAsArray) {\n      this.parseRow = this._parseRowAsArray;\n    }\n  } // adds a command complete message\n\n\n  addCommandComplete(msg) {\n    var match;\n\n    if (msg.text) {\n      // pure javascript\n      match = matchRegexp.exec(msg.text);\n    } else {\n      // native bindings\n      match = matchRegexp.exec(msg.command);\n    }\n\n    if (match) {\n      this.command = match[1];\n\n      if (match[3]) {\n        // COMMMAND OID ROWS\n        this.oid = parseInt(match[2], 10);\n        this.rowCount = parseInt(match[3], 10);\n      } else if (match[2]) {\n        // COMMAND ROWS\n        this.rowCount = parseInt(match[2], 10);\n      }\n    }\n  }\n\n  _parseRowAsArray(rowData) {\n    var row = new Array(rowData.length);\n\n    for (var i = 0, len = rowData.length; i < len; i++) {\n      var rawValue = rowData[i];\n\n      if (rawValue !== null) {\n        row[i] = this._parsers[i](rawValue);\n      } else {\n        row[i] = null;\n      }\n    }\n\n    return row;\n  }\n\n  parseRow(rowData) {\n    var row = {};\n\n    for (var i = 0, len = rowData.length; i < len; i++) {\n      var rawValue = rowData[i];\n      var field = this.fields[i].name;\n\n      if (rawValue !== null) {\n        row[field] = this._parsers[i](rawValue);\n      } else {\n        row[field] = null;\n      }\n    }\n\n    return row;\n  }\n\n  addRow(row) {\n    this.rows.push(row);\n  }\n\n  addFields(fieldDescriptions) {\n    // clears field definitions\n    // multiple query statements in 1 action can result in multiple sets\n    // of rowDescriptions...eg: 'select NOW(); select 1::int;'\n    // you need to reset the fields\n    this.fields = fieldDescriptions;\n\n    if (this.fields.length) {\n      this._parsers = new Array(fieldDescriptions.length);\n    }\n\n    for (var i = 0; i < fieldDescriptions.length; i++) {\n      var desc = fieldDescriptions[i];\n\n      if (this._types) {\n        this._parsers[i] = this._types.getTypeParser(desc.dataTypeID, desc.format || 'text');\n      } else {\n        this._parsers[i] = types.getTypeParser(desc.dataTypeID, desc.format || 'text');\n      }\n    }\n  }\n\n}\n\nmodule.exports = Result;","map":{"version":3,"names":["types","require","matchRegexp","Result","constructor","rowMode","command","rowCount","oid","rows","fields","_parsers","undefined","_types","RowCtor","rowAsArray","parseRow","_parseRowAsArray","addCommandComplete","msg","match","text","exec","parseInt","rowData","row","Array","length","i","len","rawValue","field","name","addRow","push","addFields","fieldDescriptions","desc","getTypeParser","dataTypeID","format","module","exports"],"sources":["/home/brian/node_modules/pg/lib/result.js"],"sourcesContent":["'use strict'\n\nvar types = require('pg-types')\n\nvar matchRegexp = /^([A-Za-z]+)(?: (\\d+))?(?: (\\d+))?/\n\n// result object returned from query\n// in the 'end' event and also\n// passed as second argument to provided callback\nclass Result {\n  constructor(rowMode, types) {\n    this.command = null\n    this.rowCount = null\n    this.oid = null\n    this.rows = []\n    this.fields = []\n    this._parsers = undefined\n    this._types = types\n    this.RowCtor = null\n    this.rowAsArray = rowMode === 'array'\n    if (this.rowAsArray) {\n      this.parseRow = this._parseRowAsArray\n    }\n  }\n\n  // adds a command complete message\n  addCommandComplete(msg) {\n    var match\n    if (msg.text) {\n      // pure javascript\n      match = matchRegexp.exec(msg.text)\n    } else {\n      // native bindings\n      match = matchRegexp.exec(msg.command)\n    }\n    if (match) {\n      this.command = match[1]\n      if (match[3]) {\n        // COMMMAND OID ROWS\n        this.oid = parseInt(match[2], 10)\n        this.rowCount = parseInt(match[3], 10)\n      } else if (match[2]) {\n        // COMMAND ROWS\n        this.rowCount = parseInt(match[2], 10)\n      }\n    }\n  }\n\n  _parseRowAsArray(rowData) {\n    var row = new Array(rowData.length)\n    for (var i = 0, len = rowData.length; i < len; i++) {\n      var rawValue = rowData[i]\n      if (rawValue !== null) {\n        row[i] = this._parsers[i](rawValue)\n      } else {\n        row[i] = null\n      }\n    }\n    return row\n  }\n\n  parseRow(rowData) {\n    var row = {}\n    for (var i = 0, len = rowData.length; i < len; i++) {\n      var rawValue = rowData[i]\n      var field = this.fields[i].name\n      if (rawValue !== null) {\n        row[field] = this._parsers[i](rawValue)\n      } else {\n        row[field] = null\n      }\n    }\n    return row\n  }\n\n  addRow(row) {\n    this.rows.push(row)\n  }\n\n  addFields(fieldDescriptions) {\n    // clears field definitions\n    // multiple query statements in 1 action can result in multiple sets\n    // of rowDescriptions...eg: 'select NOW(); select 1::int;'\n    // you need to reset the fields\n    this.fields = fieldDescriptions\n    if (this.fields.length) {\n      this._parsers = new Array(fieldDescriptions.length)\n    }\n    for (var i = 0; i < fieldDescriptions.length; i++) {\n      var desc = fieldDescriptions[i]\n      if (this._types) {\n        this._parsers[i] = this._types.getTypeParser(desc.dataTypeID, desc.format || 'text')\n      } else {\n        this._parsers[i] = types.getTypeParser(desc.dataTypeID, desc.format || 'text')\n      }\n    }\n  }\n}\n\nmodule.exports = Result\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}