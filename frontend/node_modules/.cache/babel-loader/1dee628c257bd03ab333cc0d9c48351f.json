{"ast":null,"code":"'use strict';\n\nconst _ = require('lodash');\n\nconst Promise = require('../../promise');\n\nconst sequelizeErrors = require('../../errors');\n\nconst QueryTypes = require('../../query-types');\n/**\n Returns an object that treats SQLite's inabilities to do certain queries.\n\n @class QueryInterface\n @static\n @private\n */\n\n/**\n  A wrapper that fixes SQLite's inability to remove columns from existing tables.\n  It will create a backup of the table, drop the table afterwards and create a\n  new table with the same name but without the obsolete column.\n\n  @param  {QueryInterface} qi\n  @param  {string} tableName     The name of the table.\n  @param  {string} attributeName The name of the attribute that we want to remove.\n  @param  {Object} options\n  @param  {boolean|Function} [options.logging] A function that logs the sql queries, or false for explicitly not logging these queries\n\n  @since 1.6.0\n  @private\n */\n\n\nfunction removeColumn(qi, tableName, attributeName, options) {\n  options = options || {};\n  return qi.describeTable(tableName, options).then(fields => {\n    delete fields[attributeName];\n    const sql = qi.QueryGenerator.removeColumnQuery(tableName, fields);\n    const subQueries = sql.split(';').filter(q => q !== '');\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({\n      raw: true\n    }, options)));\n  });\n}\n\nexports.removeColumn = removeColumn;\n/**\n  A wrapper that fixes SQLite's inability to change columns from existing tables.\n  It will create a backup of the table, drop the table afterwards and create a\n  new table with the same name but with a modified version of the respective column.\n\n  @param  {QueryInterface} qi\n  @param  {string} tableName The name of the table.\n  @param  {Object} attributes An object with the attribute's name as key and its options as value object.\n  @param  {Object} options\n  @param  {boolean|Function} [options.logging] A function that logs the sql queries, or false for explicitly not logging these queries\n\n  @since 1.6.0\n  @private\n */\n\nfunction changeColumn(qi, tableName, attributes, options) {\n  const attributeName = Object.keys(attributes)[0];\n  options = options || {};\n  return qi.describeTable(tableName, options).then(fields => {\n    Object.assign(fields[attributeName], attributes[attributeName]);\n    const sql = qi.QueryGenerator.removeColumnQuery(tableName, fields);\n    const subQueries = sql.split(';').filter(q => q !== '');\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({\n      raw: true\n    }, options)));\n  });\n}\n\nexports.changeColumn = changeColumn;\n/**\n  A wrapper that fixes SQLite's inability to rename columns from existing tables.\n  It will create a backup of the table, drop the table afterwards and create a\n  new table with the same name but with a renamed version of the respective column.\n\n  @param  {QueryInterface} qi\n  @param  {string} tableName The name of the table.\n  @param  {string} attrNameBefore The name of the attribute before it was renamed.\n  @param  {string} attrNameAfter The name of the attribute after it was renamed.\n  @param  {Object} options\n  @param  {boolean|Function} [options.logging] A function that logs the sql queries, or false for explicitly not logging these queries\n\n  @since 1.6.0\n  @private\n */\n\nfunction renameColumn(qi, tableName, attrNameBefore, attrNameAfter, options) {\n  options = options || {};\n  return qi.describeTable(tableName, options).then(fields => {\n    fields[attrNameAfter] = _.clone(fields[attrNameBefore]);\n    delete fields[attrNameBefore];\n    const sql = qi.QueryGenerator.renameColumnQuery(tableName, attrNameBefore, attrNameAfter, fields);\n    const subQueries = sql.split(';').filter(q => q !== '');\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({\n      raw: true\n    }, options)));\n  });\n}\n\nexports.renameColumn = renameColumn;\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {string} constraintName\n * @param {Object} options\n *\n * @private\n */\n\nfunction removeConstraint(qi, tableName, constraintName, options) {\n  let createTableSql;\n  return qi.showConstraint(tableName, constraintName).then(constraints => {\n    // sqlite can't show only one constraint, so we find here the one to remove\n    const constraint = constraints.find(constaint => constaint.constraintName === constraintName);\n\n    if (constraint) {\n      createTableSql = constraint.sql;\n      constraint.constraintName = qi.QueryGenerator.quoteIdentifier(constraint.constraintName);\n      let constraintSnippet = `, CONSTRAINT ${constraint.constraintName} ${constraint.constraintType} ${constraint.constraintCondition}`;\n\n      if (constraint.constraintType === 'FOREIGN KEY') {\n        const referenceTableName = qi.QueryGenerator.quoteTable(constraint.referenceTableName);\n        constraint.referenceTableKeys = constraint.referenceTableKeys.map(columnName => qi.QueryGenerator.quoteIdentifier(columnName));\n        const referenceTableKeys = constraint.referenceTableKeys.join(', ');\n        constraintSnippet += ` REFERENCES ${referenceTableName} (${referenceTableKeys})`;\n        constraintSnippet += ` ON UPDATE ${constraint.updateAction}`;\n        constraintSnippet += ` ON DELETE ${constraint.deleteAction}`;\n      }\n\n      createTableSql = createTableSql.replace(constraintSnippet, '');\n      createTableSql += ';';\n      return qi.describeTable(tableName, options);\n    }\n\n    throw new sequelizeErrors.UnknownConstraintError({\n      message: `Constraint ${constraintName} on table ${tableName} does not exist`,\n      constraint: constraintName,\n      table: tableName\n    });\n  }).then(fields => {\n    const sql = qi.QueryGenerator._alterConstraintQuery(tableName, fields, createTableSql);\n\n    const subQueries = sql.split(';').filter(q => q !== '');\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({\n      raw: true\n    }, options)));\n  });\n}\n\nexports.removeConstraint = removeConstraint;\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {Object} options\n *\n * @private\n */\n\nfunction addConstraint(qi, tableName, options) {\n  const constraintSnippet = qi.QueryGenerator.getConstraintSnippet(tableName, options);\n  const describeCreateTableSql = qi.QueryGenerator.describeCreateTableQuery(tableName);\n  let createTableSql;\n  return qi.sequelize.query(describeCreateTableSql, Object.assign({}, options, {\n    type: QueryTypes.SELECT,\n    raw: true\n  })).then(constraints => {\n    const sql = constraints[0].sql;\n    const index = sql.length - 1; //Replace ending ')' with constraint snippet - Simulates String.replaceAt\n    //http://stackoverflow.com/questions/1431094\n\n    createTableSql = `${sql.substr(0, index)}, ${constraintSnippet})${sql.substr(index + 1)};`;\n    return qi.describeTable(tableName, options);\n  }).then(fields => {\n    const sql = qi.QueryGenerator._alterConstraintQuery(tableName, fields, createTableSql);\n\n    const subQueries = sql.split(';').filter(q => q !== '');\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({\n      raw: true\n    }, options)));\n  });\n}\n\nexports.addConstraint = addConstraint;\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {Object} options  Query Options\n *\n * @private\n * @returns {Promise}\n */\n\nfunction getForeignKeyReferencesForTable(qi, tableName, options) {\n  const database = qi.sequelize.config.database;\n  const query = qi.QueryGenerator.getForeignKeysQuery(tableName, database);\n  return qi.sequelize.query(query, options).then(result => {\n    return result.map(row => ({\n      tableName,\n      columnName: row.from,\n      referencedTableName: row.table,\n      referencedColumnName: row.to,\n      tableCatalog: database,\n      referencedTableCatalog: database\n    }));\n  });\n}\n\nexports.getForeignKeyReferencesForTable = getForeignKeyReferencesForTable;\n/**\n * Describe a table structure\n *\n * This method returns an array of hashes containing information about all attributes in the table.\n *\n * ```js\n * {\n *    name: {\n *      type:         'VARCHAR(255)', // this will be 'CHARACTER VARYING' for pg!\n *      allowNull:    true,\n *      defaultValue: null,\n *      unique:       true,           // available for sqlite only\n *      references:   {},             // available for sqlite only\n *    },\n *    isBetaMember: {\n *      type:         'TINYINT(1)', // this will be 'BOOLEAN' for pg!\n *      allowNull:    false,\n *      defaultValue: false,\n *      unique:       false,        // available for sqlite only\n *      references:   {},           // available for sqlite only\n *    }\n * }\n * ```\n *\n * @param {QueryInterface} qi\n * @param {string} tableName table name\n * @param {Object} [options] Query options\n *\n * @returns {Promise<Object>}\n */\n\nfunction describeTable(qi, tableName, options) {\n  let schema = null;\n  let schemaDelimiter = null;\n\n  if (typeof options === 'string') {\n    schema = options;\n  } else if (typeof options === 'object' && options !== null) {\n    schema = options.schema || null;\n    schemaDelimiter = options.schemaDelimiter || null;\n  }\n\n  if (typeof tableName === 'object' && tableName !== null) {\n    schema = tableName.schema;\n    tableName = tableName.tableName;\n  }\n\n  const sql = qi.QueryGenerator.describeTableQuery(tableName, schema, schemaDelimiter);\n  options = Object.assign({}, options, {\n    type: QueryTypes.DESCRIBE\n  });\n  return qi.sequelize.query(sql, options).then(data => {\n    /*\n      * If no data is returned from the query, then the table name may be wrong.\n      * Query generators that use information_schema for retrieving table info will just return an empty result set,\n      * it will not throw an error like built-ins do (e.g. DESCRIBE on MySql).\n      */\n    if (_.isEmpty(data)) {\n      throw new Error(`No description found for \"${tableName}\" table. Check the table name and schema; remember, they _are_ case sensitive.`);\n    }\n\n    return qi.showIndex(tableName, options).then(indexes => {\n      for (const prop in data) {\n        data[prop].unique = false;\n      }\n\n      for (const index of indexes) {\n        for (const field of index.fields) {\n          if (index.unique !== undefined) {\n            data[field.attribute].unique = index.unique;\n          }\n        }\n      }\n\n      return qi.getForeignKeyReferencesForTable(tableName, options).then(foreignKeys => {\n        for (const foreignKey of foreignKeys) {\n          data[foreignKey.columnName].references = {\n            model: foreignKey.referencedTableName,\n            key: foreignKey.referencedColumnName\n          };\n        }\n\n        return data;\n      });\n    });\n  }).catch(e => {\n    if (e.original && e.original.code === 'ER_NO_SUCH_TABLE') {\n      throw Error(`No description found for \"${tableName}\" table. Check the table name and schema; remember, they _are_ case sensitive.`);\n    }\n\n    throw e;\n  });\n}\n\nexports.describeTable = describeTable;","map":{"version":3,"names":["_","require","Promise","sequelizeErrors","QueryTypes","removeColumn","qi","tableName","attributeName","options","describeTable","then","fields","sql","QueryGenerator","removeColumnQuery","subQueries","split","filter","q","each","subQuery","sequelize","query","Object","assign","raw","exports","changeColumn","attributes","keys","renameColumn","attrNameBefore","attrNameAfter","clone","renameColumnQuery","removeConstraint","constraintName","createTableSql","showConstraint","constraints","constraint","find","constaint","quoteIdentifier","constraintSnippet","constraintType","constraintCondition","referenceTableName","quoteTable","referenceTableKeys","map","columnName","join","updateAction","deleteAction","replace","UnknownConstraintError","message","table","_alterConstraintQuery","addConstraint","getConstraintSnippet","describeCreateTableSql","describeCreateTableQuery","type","SELECT","index","length","substr","getForeignKeyReferencesForTable","database","config","getForeignKeysQuery","result","row","from","referencedTableName","referencedColumnName","to","tableCatalog","referencedTableCatalog","schema","schemaDelimiter","describeTableQuery","DESCRIBE","data","isEmpty","Error","showIndex","indexes","prop","unique","field","undefined","attribute","foreignKeys","foreignKey","references","model","key","catch","e","original","code"],"sources":["/home/brian/node_modules/sequelize/lib/dialects/sqlite/query-interface.js"],"sourcesContent":["'use strict';\n\nconst _ = require('lodash');\nconst Promise = require('../../promise');\nconst sequelizeErrors = require('../../errors');\nconst QueryTypes = require('../../query-types');\n\n/**\n Returns an object that treats SQLite's inabilities to do certain queries.\n\n @class QueryInterface\n @static\n @private\n */\n\n/**\n  A wrapper that fixes SQLite's inability to remove columns from existing tables.\n  It will create a backup of the table, drop the table afterwards and create a\n  new table with the same name but without the obsolete column.\n\n  @param  {QueryInterface} qi\n  @param  {string} tableName     The name of the table.\n  @param  {string} attributeName The name of the attribute that we want to remove.\n  @param  {Object} options\n  @param  {boolean|Function} [options.logging] A function that logs the sql queries, or false for explicitly not logging these queries\n\n  @since 1.6.0\n  @private\n */\nfunction removeColumn(qi, tableName, attributeName, options) {\n  options = options || {};\n\n  return qi.describeTable(tableName, options).then(fields => {\n    delete fields[attributeName];\n\n    const sql = qi.QueryGenerator.removeColumnQuery(tableName, fields);\n    const subQueries = sql.split(';').filter(q => q !== '');\n\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({ raw: true }, options)));\n  });\n}\nexports.removeColumn = removeColumn;\n\n/**\n  A wrapper that fixes SQLite's inability to change columns from existing tables.\n  It will create a backup of the table, drop the table afterwards and create a\n  new table with the same name but with a modified version of the respective column.\n\n  @param  {QueryInterface} qi\n  @param  {string} tableName The name of the table.\n  @param  {Object} attributes An object with the attribute's name as key and its options as value object.\n  @param  {Object} options\n  @param  {boolean|Function} [options.logging] A function that logs the sql queries, or false for explicitly not logging these queries\n\n  @since 1.6.0\n  @private\n */\nfunction changeColumn(qi, tableName, attributes, options) {\n  const attributeName = Object.keys(attributes)[0];\n  options = options || {};\n\n  return qi.describeTable(tableName, options).then(fields => {\n    Object.assign(fields[attributeName], attributes[attributeName]);\n\n    const sql = qi.QueryGenerator.removeColumnQuery(tableName, fields);\n    const subQueries = sql.split(';').filter(q => q !== '');\n\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({ raw: true }, options)));\n  });\n}\nexports.changeColumn = changeColumn;\n\n/**\n  A wrapper that fixes SQLite's inability to rename columns from existing tables.\n  It will create a backup of the table, drop the table afterwards and create a\n  new table with the same name but with a renamed version of the respective column.\n\n  @param  {QueryInterface} qi\n  @param  {string} tableName The name of the table.\n  @param  {string} attrNameBefore The name of the attribute before it was renamed.\n  @param  {string} attrNameAfter The name of the attribute after it was renamed.\n  @param  {Object} options\n  @param  {boolean|Function} [options.logging] A function that logs the sql queries, or false for explicitly not logging these queries\n\n  @since 1.6.0\n  @private\n */\nfunction renameColumn(qi, tableName, attrNameBefore, attrNameAfter, options) {\n  options = options || {};\n\n  return qi.describeTable(tableName, options).then(fields => {\n    fields[attrNameAfter] = _.clone(fields[attrNameBefore]);\n    delete fields[attrNameBefore];\n\n    const sql = qi.QueryGenerator.renameColumnQuery(tableName, attrNameBefore, attrNameAfter, fields);\n    const subQueries = sql.split(';').filter(q => q !== '');\n\n    return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({ raw: true }, options)));\n  });\n}\nexports.renameColumn = renameColumn;\n\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {string} constraintName\n * @param {Object} options\n *\n * @private\n */\nfunction removeConstraint(qi, tableName, constraintName, options) {\n  let createTableSql;\n\n  return qi.showConstraint(tableName, constraintName)\n    .then(constraints => {\n      // sqlite can't show only one constraint, so we find here the one to remove\n      const constraint = constraints.find(constaint => constaint.constraintName === constraintName);\n\n      if (constraint) {\n        createTableSql = constraint.sql;\n        constraint.constraintName = qi.QueryGenerator.quoteIdentifier(constraint.constraintName);\n        let constraintSnippet = `, CONSTRAINT ${constraint.constraintName} ${constraint.constraintType} ${constraint.constraintCondition}`;\n\n        if (constraint.constraintType === 'FOREIGN KEY') {\n          const referenceTableName = qi.QueryGenerator.quoteTable(constraint.referenceTableName);\n          constraint.referenceTableKeys = constraint.referenceTableKeys.map(columnName => qi.QueryGenerator.quoteIdentifier(columnName));\n          const referenceTableKeys = constraint.referenceTableKeys.join(', ');\n          constraintSnippet += ` REFERENCES ${referenceTableName} (${referenceTableKeys})`;\n          constraintSnippet += ` ON UPDATE ${constraint.updateAction}`;\n          constraintSnippet += ` ON DELETE ${constraint.deleteAction}`;\n        }\n\n        createTableSql = createTableSql.replace(constraintSnippet, '');\n        createTableSql += ';';\n\n        return qi.describeTable(tableName, options);\n      }\n      throw new sequelizeErrors.UnknownConstraintError({\n        message: `Constraint ${constraintName} on table ${tableName} does not exist`,\n        constraint: constraintName,\n        table: tableName\n      });\n    })\n    .then(fields => {\n      const sql = qi.QueryGenerator._alterConstraintQuery(tableName, fields, createTableSql);\n      const subQueries = sql.split(';').filter(q => q !== '');\n\n      return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({ raw: true }, options)));\n    });\n}\nexports.removeConstraint = removeConstraint;\n\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {Object} options\n *\n * @private\n */\nfunction addConstraint(qi, tableName, options) {\n  const constraintSnippet = qi.QueryGenerator.getConstraintSnippet(tableName, options);\n  const describeCreateTableSql = qi.QueryGenerator.describeCreateTableQuery(tableName);\n  let createTableSql;\n\n  return qi.sequelize.query(describeCreateTableSql, Object.assign({}, options, { type: QueryTypes.SELECT, raw: true }))\n    .then(constraints => {\n      const sql = constraints[0].sql;\n      const index = sql.length - 1;\n      //Replace ending ')' with constraint snippet - Simulates String.replaceAt\n      //http://stackoverflow.com/questions/1431094\n      createTableSql = `${sql.substr(0, index)}, ${constraintSnippet})${sql.substr(index + 1)};`;\n\n      return qi.describeTable(tableName, options);\n    })\n    .then(fields => {\n      const sql = qi.QueryGenerator._alterConstraintQuery(tableName, fields, createTableSql);\n      const subQueries = sql.split(';').filter(q => q !== '');\n\n      return Promise.each(subQueries, subQuery => qi.sequelize.query(`${subQuery};`, Object.assign({ raw: true }, options)));\n    });\n}\nexports.addConstraint = addConstraint;\n\n/**\n * @param {QueryInterface} qi\n * @param {string} tableName\n * @param {Object} options  Query Options\n *\n * @private\n * @returns {Promise}\n */\nfunction getForeignKeyReferencesForTable(qi, tableName, options) {\n  const database = qi.sequelize.config.database;\n  const query = qi.QueryGenerator.getForeignKeysQuery(tableName, database);\n  return qi.sequelize.query(query, options)\n    .then(result => {\n      return result.map(row => ({\n        tableName,\n        columnName: row.from,\n        referencedTableName: row.table,\n        referencedColumnName: row.to,\n        tableCatalog: database,\n        referencedTableCatalog: database\n      }));\n    });\n}\n\nexports.getForeignKeyReferencesForTable = getForeignKeyReferencesForTable;\n\n/**\n * Describe a table structure\n *\n * This method returns an array of hashes containing information about all attributes in the table.\n *\n * ```js\n * {\n *    name: {\n *      type:         'VARCHAR(255)', // this will be 'CHARACTER VARYING' for pg!\n *      allowNull:    true,\n *      defaultValue: null,\n *      unique:       true,           // available for sqlite only\n *      references:   {},             // available for sqlite only\n *    },\n *    isBetaMember: {\n *      type:         'TINYINT(1)', // this will be 'BOOLEAN' for pg!\n *      allowNull:    false,\n *      defaultValue: false,\n *      unique:       false,        // available for sqlite only\n *      references:   {},           // available for sqlite only\n *    }\n * }\n * ```\n *\n * @param {QueryInterface} qi\n * @param {string} tableName table name\n * @param {Object} [options] Query options\n *\n * @returns {Promise<Object>}\n */\nfunction describeTable(qi, tableName, options) {\n  let schema = null;\n  let schemaDelimiter = null;\n\n  if (typeof options === 'string') {\n    schema = options;\n  } else if (typeof options === 'object' && options !== null) {\n    schema = options.schema || null;\n    schemaDelimiter = options.schemaDelimiter || null;\n  }\n\n  if (typeof tableName === 'object' && tableName !== null) {\n    schema = tableName.schema;\n    tableName = tableName.tableName;\n  }\n\n  const sql = qi.QueryGenerator.describeTableQuery(tableName, schema, schemaDelimiter);\n  options = Object.assign({}, options, { type: QueryTypes.DESCRIBE });\n\n  return qi.sequelize.query(sql, options).then(data => {\n    /*\n      * If no data is returned from the query, then the table name may be wrong.\n      * Query generators that use information_schema for retrieving table info will just return an empty result set,\n      * it will not throw an error like built-ins do (e.g. DESCRIBE on MySql).\n      */\n    if (_.isEmpty(data)) {\n      throw new Error(`No description found for \"${tableName}\" table. Check the table name and schema; remember, they _are_ case sensitive.`);\n    }\n\n    return qi.showIndex(tableName, options).then(indexes => {\n      for (const prop in data) {\n        data[prop].unique = false;\n      }\n      for (const index of indexes) {\n        for (const field of index.fields) {\n          if (index.unique !== undefined) {\n            data[field.attribute].unique = index.unique;\n          }\n        }\n      }\n\n      return qi.getForeignKeyReferencesForTable(tableName, options).then(foreignKeys => {\n        for (const foreignKey of foreignKeys) {\n          data[foreignKey.columnName].references = {\n            model: foreignKey.referencedTableName,\n            key: foreignKey.referencedColumnName\n          };\n        }\n        return data;\n      });\n    });\n  }).catch(e => {\n    if (e.original && e.original.code === 'ER_NO_SUCH_TABLE') {\n      throw Error(`No description found for \"${tableName}\" table. Check the table name and schema; remember, they _are_ case sensitive.`);\n    }\n\n    throw e;\n  });\n}\nexports.describeTable = describeTable;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}