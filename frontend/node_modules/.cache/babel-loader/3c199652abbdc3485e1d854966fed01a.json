{"ast":null,"code":"\"use strict\";\n\nconst {\n  TimeoutError\n} = require(\"./TimeoutError\");\n\nclass Deferred {\n  constructor() {\n    this._timeout = null;\n    this._promise = new Promise((resolve, reject) => {\n      this._reject = reject;\n      this._resolve = resolve;\n    });\n  }\n\n  registerTimeout(timeoutInMillis, callback) {\n    if (this._timeout) return;\n    this._timeout = setTimeout(() => {\n      callback();\n      this.reject(new TimeoutError(\"Operation timeout\"));\n    }, timeoutInMillis);\n  }\n\n  _clearTimeout() {\n    if (!this._timeout) return;\n    clearTimeout(this._timeout);\n    this._timeout = null;\n  }\n\n  resolve(value) {\n    this._clearTimeout();\n\n    this._resolve(value);\n  }\n\n  reject(error) {\n    this._clearTimeout();\n\n    this._reject(error);\n  }\n\n  promise() {\n    return this._promise;\n  }\n\n}\n\nmodule.exports = Deferred;","map":{"version":3,"names":["TimeoutError","require","Deferred","constructor","_timeout","_promise","Promise","resolve","reject","_reject","_resolve","registerTimeout","timeoutInMillis","callback","setTimeout","_clearTimeout","clearTimeout","value","error","promise","module","exports"],"sources":["/home/brian/node_modules/sequelize-pool/lib/Deferred.js"],"sourcesContent":["\"use strict\";\n\nconst { TimeoutError } = require(\"./TimeoutError\");\n\nclass Deferred {\n  constructor() {\n    this._timeout = null;\n    this._promise = new Promise((resolve, reject) => {\n      this._reject = reject;\n      this._resolve = resolve;\n    });\n  }\n\n  registerTimeout(timeoutInMillis, callback) {\n    if (this._timeout) return;\n\n    this._timeout = setTimeout(() => {\n      callback();\n      this.reject(new TimeoutError(\"Operation timeout\"));\n    }, timeoutInMillis);\n  }\n\n  _clearTimeout() {\n    if (!this._timeout) return;\n\n    clearTimeout(this._timeout);\n    this._timeout = null;\n  }\n\n  resolve(value) {\n    this._clearTimeout();\n    this._resolve(value);\n  }\n\n  reject(error) {\n    this._clearTimeout();\n    this._reject(error);\n  }\n\n  promise() {\n    return this._promise;\n  }\n}\n\nmodule.exports = Deferred;\n"],"mappings":"AAAA;;AAEA,MAAM;EAAEA;AAAF,IAAmBC,OAAO,CAAC,gBAAD,CAAhC;;AAEA,MAAMC,QAAN,CAAe;EACbC,WAAW,GAAG;IACZ,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,QAAL,GAAgB,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;MAC/C,KAAKC,OAAL,GAAeD,MAAf;MACA,KAAKE,QAAL,GAAgBH,OAAhB;IACD,CAHe,CAAhB;EAID;;EAEDI,eAAe,CAACC,eAAD,EAAkBC,QAAlB,EAA4B;IACzC,IAAI,KAAKT,QAAT,EAAmB;IAEnB,KAAKA,QAAL,GAAgBU,UAAU,CAAC,MAAM;MAC/BD,QAAQ;MACR,KAAKL,MAAL,CAAY,IAAIR,YAAJ,CAAiB,mBAAjB,CAAZ;IACD,CAHyB,EAGvBY,eAHuB,CAA1B;EAID;;EAEDG,aAAa,GAAG;IACd,IAAI,CAAC,KAAKX,QAAV,EAAoB;IAEpBY,YAAY,CAAC,KAAKZ,QAAN,CAAZ;IACA,KAAKA,QAAL,GAAgB,IAAhB;EACD;;EAEDG,OAAO,CAACU,KAAD,EAAQ;IACb,KAAKF,aAAL;;IACA,KAAKL,QAAL,CAAcO,KAAd;EACD;;EAEDT,MAAM,CAACU,KAAD,EAAQ;IACZ,KAAKH,aAAL;;IACA,KAAKN,OAAL,CAAaS,KAAb;EACD;;EAEDC,OAAO,GAAG;IACR,OAAO,KAAKd,QAAZ;EACD;;AArCY;;AAwCfe,MAAM,CAACC,OAAP,GAAiBnB,QAAjB"},"metadata":{},"sourceType":"script"}